<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="SegDaMstrDAO">

	<select id="selectSegDaInfo" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		/* SegDaMstrDAO.selectSegDaInfo */
		SELECT   SEGDA_ID  
	      ,  IU_TYPE  
	      ,  SEG_CNT  
	      ,  SEG_SQL  
	      ,  SEG_TYPE  
	      ,  CL_RS_PATH  
	      ,  CL_RS_JSON  
	      ,  USE_YN  
	      ,  DEL_YN  
	      ,  REG_USER_NO  
	      ,  REG_DT  
	      ,  UPD_USER_NO  
	      ,  UPD_DT  
	    FROM   WP2_SEG_DA_MSTR 
  		WHERE SEGDA_ID = #SEGDA_ID#
	</select>
	
	<insert id="insert" parameterClass="java.util.Map">
		INSERT 
		  INTO   WP2_SEG_DA_MSTR  
	           (  IU_TYPE  
	           ,  SEG_CNT 
	           ,  SEG_SQL 
	           ,  SEG_TYPE   
	           <!--,  CL_RS_PATH 
	           ,  CL_RS_JSON -->   
	           ,  USE_YN 
	           ,  DEL_YN  
	           ,  REG_USER_NO  
	           ,  REG_DT   )
     	 VALUES (
     	 		 #IU_TYPE#  
	           , #SEG_CNT# 
	           , dbo.F_ENCRYPT(#SEG_SQL#)
			    , #SEG_TYPE#  
	           <!--, #CL_RS_PATH#
	           , #CL_RS_JSON# -->
	           , 'Y'
	           , 'N'
			   , #USER_NO#
			   , NOW() 
     	 )
		<selectKey keyProperty="SEGDA_ID" resultClass="Integer">
			SELECT ident_current('WP2_SEG_DA_MSTR')
		</selectKey>
	</insert> 	

	<update id="update" parameterClass="java.util.Map">
		UPDATE   WP2_SEG_DA_MSTR  
	       SET   IU_TYPE  = #IU_TYPE#
	           ,  SEG_CNT = #SEG_CNT# 
	           ,  SEG_SQL = dbo.F_ENCRYPT(#SEG_SQL#)
	           ,  SEG_TYPE = #SEG_TYPE#  
	           ,  UPD_USER_NO = #USER_NO#    
	           ,  UPD_DT  = NOW() 
  		WHERE SEGDA_ID = #SEGDA_ID# 
	</update> 
	<!-- 테스트 분석결과  update -->
	<update id="updatePythonResult" parameterClass="java.util.Map">
	update WP2_SEG_DA_MSTR 
	set CL_RS_JSON = #NODE#
	  , SEG_TYPE = #SEG_TYPE#
  	WHERE SEGDA_ID = #SEGDA_ID#  
	</update> 
	
	<!-- 테스트를 위해 임시로 분석결과 update -->
	<update id="updateResultForTest" parameterClass="java.util.Map">
	update WP2_SEG_DA_MSTR 
	set CL_RS_JSON = (select CL_RS_JSON from WP2_SEG_DA_MSTR where segda_id = 1001)
	  , SEG_TYPE = 'ML'
  	WHERE SEGDA_ID = #SEGDA_ID#  
	</update>
</sqlMap>